{% extends "landing/base_promote.html" %}

{% block pageid %}promote-buttons{% endblock %}

{% block title %}{{ page_title(_('Promote MDN')) }}{% endblock %}

{% block extrahead %}
<style type="text/css">
#step-design { float: left; }
#step-design ul { }
#step-design ul li { display: inline; }
#step-design ul li input { }
#step-design ul li.selected img { }
#step-color { display: none; float: left;  clear: left; padding: 0 0.5em 0 0.5em; }
#step-topic { display: none; float: left; padding: 0 0.5em 0 0.5em; }
#step-topic label a { display: block }
#button-preview { display: none; margin-left: 66%; }    
</style>
{% endblock %}

{% block content %}
  <header id="page-head">
    <div class="wrap">
      {# <nav class="crumb"><a href="{{ url('promote') }}">{{ _('Back to Home') }}</a></nav> #}
      <h1 class="page-title">{{ _('Promote MDN') }}</h1>
      <h2 class="page-subtitle">{{ _('Spread some developer love.') }}</h2>
      {% trans %}
      <p class="intro">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse ut nulla eros. Morbi ultrices ornare adipiscing. Nam ac justo enim.</p>
      {% endtrans %}
    </div> 
  </header>

<section id="content">
<div class="wrap">

  <section id="content-main" class="full" role="main">
  
    <div id="" class="">
        <form id="button-builder">
            <p>Intro copy. Suspendisse ut nulla eros.</p>

            <section id="step-design">
                <h3>{{_('1. Pick your button style')}}</h3>
                <ul>
                    <li>
                        <input type="radio" name="button-design" value="betterdocs" id="button-design-betterdocs">
                        <label for="button-design-betterdocs">
                            <img src="{{ MEDIA_URL }}img/promote/betterdocs_foo.png" alt="{{_('Better Docs')}}" />
                        </label>
                    </li>
                    <li>
                        <input type="radio" name="button-design" value="devpowered" id="button-design-devpowered">
                        <label for="button-design-devpowered">
                            <img src="{{ MEDIA_URL }}img/promote/devpowered_foo.png" alt="{{_('Developer Powered')}}" />
                        </label>
                    </li>
                    <li>
                        <input type="radio" name="button-design" value="bydev" id="button-design-bydev">
                        <label for="button-design-bydev">
                            <img src="{{ MEDIA_URL }}img/promote/bydev_foo.png" alt="{{_('For Developers, By Developers')}}" />
                        </label>
                    </li>
                    <li>
                        <input type="radio" name="button-design" value="devtoolbox" id="button-design-devtoolbox">
                        <label for="button-design-devtoolbox">
                            <img src="{{ MEDIA_URL }}img/promote/devtoolbox_foo.png" alt="{{_('Web Developer Toolbox')}}" />
                        </label>
                    </li>
                </ul>
            </section>

            <section id="step-color">
                <h3>{{_('2. Choose a color')}}</h3>
                <ul>
                    <li><input id="button-color-gray" name="button-color" type="radio" value="gray" />
                        <label for="button-color-gray">{{_('Gray')}}</label></li>
                    <li><input id="button-color-orange" name="button-color" type="radio" value="orange" />
                        <label for="button-color-orange">{{_('Orange')}}</label></li>
                    <li><input id="button-color-red" name="button-color" type="radio" value="red" />
                        <label for="button-color-red">{{_('Red')}}</label></li>
                </ul>
            </section>

            <section id="step-topic">
                <h3>{{_('3. Replace <FOO> with')}}</h3>
                <ul>
                    <li>
                        <input id="button-topic-css" name="button-topic" type="radio" value="css" />
                        <label for="button-topic-css">
                            <span>{{_('CSS')}}</span>
                            <a href="http://developer.mozilla.org/docs/css">http://developer.mozilla.org/docs/css</a>
                        </label>
                    </li>
                    <li>
                        <input id="button-topic-html" name="button-topic" type="radio" value="html" />
                        <label for="button-topic-html">
                            <span>{{_('HTML')}}</span>
                            <a href="http://developer.mozilla.org/docs/html">http://developer.mozilla.org/docs/html</a>
                        </label>
                    </li>
                    <li>
                        <input id="button-topic-js" name="button-topic" type="radio" value="js" />
                        <label for="button-topic-js">
                            <span>{{_('JavaScript')}}</span>
                            <a href="http://developer.mozilla.org/docs/js">http://developer.mozilla.org/docs/js</a>
                        </label>
                    </li>
                    <li>
                        <input id="button-topic-web" name="button-topic" type="radio" value="web" />
                        <label for="button-topic-web">
                            <span>{{_('Web')}}</span>
                            <a href="http://developer.mozilla.org/docs/">http://developer.mozilla.org/docs/</a>
                       </label>
                    </li>
                </ul>
            </section>

            <section id="button-preview">
                <h3>{{_('Your custom button preview:')}}</h3>
                    <div><img id="button-image" src="" width="" height="" /></div>
                <h4>{{_('And your source code:')}}</h4>
                    <textarea id="button-code" cols="40" rows="7"></textarea>
                <h4>{{_('Adding that code will take people to:')}}</h4>
                    <a id="button-url" href="#">...</a>
            </section>

        </form>
    </div>
    
  </section><!-- /#content-main -->

</div>
</section>

{% endblock %}

{% block js %}
<script type="text/javascript">
// <![CDATA[

function rowsToObjects (col_names, rows) {
    var items = [];
    for (var i=0,row; row=rows[i]; i++) {
        var item = {};
        for (var j=0,col_name; col_name=col_names[j]; j++) {
            item[col_name] = row[j];
        }
        items.push(item);
    }
    return items;
}

var buttons = rowsToObjects(
    [ "design","topic","color","url","wt","id","tracked_url" ],
    [
        [ "betterdocs","css","gray","https:\/\/developer.mozilla.org\/docs\/css","\/?WT.mc_id=","mdn1","https:\/\/developer.mozilla.org\/docs\/css\/?WT.mc_id=mdn1" ],
        [ "betterdocs","html","gray","https:\/\/developer.mozilla.org\/docs\/html","\/?WT.mc_id=","mdn2","https:\/\/developer.mozilla.org\/docs\/html\/?WT.mc_id=mdn2" ],
        [ "betterdocs","js","gray","https:\/\/developer.mozilla.org\/docs\/js","\/?WT.mc_id=","mdn3","https:\/\/developer.mozilla.org\/docs\/js\/?WT.mc_id=mdn3" ],
        [ "betterdocs","web","gray","https:\/\/developer.mozilla.org\/docs","\/?WT.mc_id=","mdn4","https:\/\/developer.mozilla.org\/docs\/?WT.mc_id=mdn4" ],
        [ "betterdocs","css","orange","https:\/\/developer.mozilla.org\/docs\/css","\/?WT.mc_id=","mdn5","https:\/\/developer.mozilla.org\/docs\/css\/?WT.mc_id=mdn5" ],
        [ "betterdocs","html","orange","https:\/\/developer.mozilla.org\/docs\/html","\/?WT.mc_id=","mdn6","https:\/\/developer.mozilla.org\/docs\/html\/?WT.mc_id=mdn6" ],
        [ "betterdocs","js","orange","https:\/\/developer.mozilla.org\/docs\/js","\/?WT.mc_id=","mdn7","https:\/\/developer.mozilla.org\/docs\/js\/?WT.mc_id=mdn7" ],
        [ "betterdocs","web","orange","https:\/\/developer.mozilla.org\/docs","\/?WT.mc_id=","mdn8","https:\/\/developer.mozilla.org\/docs\/?WT.mc_id=mdn8" ],
        [ "betterdocs","css","red","https:\/\/developer.mozilla.org\/docs\/css","\/?WT.mc_id=","mdn9","https:\/\/developer.mozilla.org\/docs\/css\/?WT.mc_id=mdn9" ],
        [ "betterdocs","html","red","https:\/\/developer.mozilla.org\/docs\/html","\/?WT.mc_id=","mdn10","https:\/\/developer.mozilla.org\/docs\/html\/?WT.mc_id=mdn10" ],
        [ "betterdocs","js","red","https:\/\/developer.mozilla.org\/docs\/js","\/?WT.mc_id=","mdn11","https:\/\/developer.mozilla.org\/docs\/js\/?WT.mc_id=mdn11" ],
        [ "betterdocs","web","red","https:\/\/developer.mozilla.org\/docs","\/?WT.mc_id=","mdn12","https:\/\/developer.mozilla.org\/docs\/?WT.mc_id=mdn12" ],
        [ "devpowered","css","gray","https:\/\/developer.mozilla.org\/docs\/css","\/?WT.mc_id=","mdn13","https:\/\/developer.mozilla.org\/docs\/css\/?WT.mc_id=mdn13" ],
        [ "devpowered","html","gray","https:\/\/developer.mozilla.org\/docs\/html","\/?WT.mc_id=","mdn14","https:\/\/developer.mozilla.org\/docs\/html\/?WT.mc_id=mdn14" ],
        [ "devpowered","js","gray","https:\/\/developer.mozilla.org\/docs\/js","\/?WT.mc_id=","mdn15","https:\/\/developer.mozilla.org\/docs\/js\/?WT.mc_id=mdn15" ],
        [ "devpowered","web","gray","https:\/\/developer.mozilla.org\/docs","\/?WT.mc_id=","mdn16","https:\/\/developer.mozilla.org\/docs\/?WT.mc_id=mdn16" ],
        [ "devpowered","css","orange","https:\/\/developer.mozilla.org\/docs\/css","\/?WT.mc_id=","mdn17","https:\/\/developer.mozilla.org\/docs\/css\/?WT.mc_id=mdn17" ],
        [ "devpowered","html","orange","https:\/\/developer.mozilla.org\/docs\/html","\/?WT.mc_id=","mdn18","https:\/\/developer.mozilla.org\/docs\/html\/?WT.mc_id=mdn18" ],
        [ "devpowered","js","orange","https:\/\/developer.mozilla.org\/docs\/js","\/?WT.mc_id=","mdn19","https:\/\/developer.mozilla.org\/docs\/js\/?WT.mc_id=mdn19" ],
        [ "devpowered","web","orange","https:\/\/developer.mozilla.org\/docs","\/?WT.mc_id=","mdn20","https:\/\/developer.mozilla.org\/docs\/?WT.mc_id=mdn20" ],
        [ "devpowered","css","red","https:\/\/developer.mozilla.org\/docs\/css","\/?WT.mc_id=","mdn21","https:\/\/developer.mozilla.org\/docs\/css\/?WT.mc_id=mdn21" ],
        [ "devpowered","html","red","https:\/\/developer.mozilla.org\/docs\/html","\/?WT.mc_id=","mdn22","https:\/\/developer.mozilla.org\/docs\/html\/?WT.mc_id=mdn22" ],
        [ "devpowered","js","red","https:\/\/developer.mozilla.org\/docs\/js","\/?WT.mc_id=","mdn23","https:\/\/developer.mozilla.org\/docs\/js\/?WT.mc_id=mdn23" ],
        [ "devpowered","web","red","https:\/\/developer.mozilla.org\/docs","\/?WT.mc_id=","mdn24","https:\/\/developer.mozilla.org\/docs\/?WT.mc_id=mdn24" ],
        [ "bydev","css","gray","https:\/\/developer.mozilla.org\/docs\/css","\/?WT.mc_id=","mdn25","https:\/\/developer.mozilla.org\/docs\/css\/?WT.mc_id=mdn25" ],
        [ "bydev","html","gray","https:\/\/developer.mozilla.org\/docs\/html","\/?WT.mc_id=","mdn26","https:\/\/developer.mozilla.org\/docs\/html\/?WT.mc_id=mdn26" ],
        [ "bydev","js","gray","https:\/\/developer.mozilla.org\/docs\/js","\/?WT.mc_id=","mdn27","https:\/\/developer.mozilla.org\/docs\/js\/?WT.mc_id=mdn27" ],
        [ "bydev","web","gray","https:\/\/developer.mozilla.org\/docs","\/?WT.mc_id=","mdn28","https:\/\/developer.mozilla.org\/docs\/?WT.mc_id=mdn28" ],
        [ "bydev","css","orange","https:\/\/developer.mozilla.org\/docs\/css","\/?WT.mc_id=","mdn29","https:\/\/developer.mozilla.org\/docs\/css\/?WT.mc_id=mdn29" ],
        [ "bydev","html","orange","https:\/\/developer.mozilla.org\/docs\/html","\/?WT.mc_id=","mdn30","https:\/\/developer.mozilla.org\/docs\/html\/?WT.mc_id=mdn30" ],
        [ "bydev","js","orange","https:\/\/developer.mozilla.org\/docs\/js","\/?WT.mc_id=","mdn31","https:\/\/developer.mozilla.org\/docs\/js\/?WT.mc_id=mdn31" ],
        [ "bydev","web","orange","https:\/\/developer.mozilla.org\/docs","\/?WT.mc_id=","mdn32","https:\/\/developer.mozilla.org\/docs\/?WT.mc_id=mdn32" ],
        [ "bydev","css","red","https:\/\/developer.mozilla.org\/docs\/css","\/?WT.mc_id=","mdn33","https:\/\/developer.mozilla.org\/docs\/css\/?WT.mc_id=mdn33" ],
        [ "bydev","html","red","https:\/\/developer.mozilla.org\/docs\/html","\/?WT.mc_id=","mdn34","https:\/\/developer.mozilla.org\/docs\/html\/?WT.mc_id=mdn34" ],
        [ "bydev","js","red","https:\/\/developer.mozilla.org\/docs\/js","\/?WT.mc_id=","mdn35","https:\/\/developer.mozilla.org\/docs\/js\/?WT.mc_id=mdn35" ],
        [ "bydev","web","red","https:\/\/developer.mozilla.org\/docs","\/?WT.mc_id=","mdn36","https:\/\/developer.mozilla.org\/docs\/?WT.mc_id=mdn36" ],
        [ "devtoolbox","---","gray","https:\/\/developer.mozilla.org\/web","\/?WT.mc_id=","mdn37","https:\/\/developer.mozilla.org\/web\/?WT.mc_id=mdn37" ],
        [ "devtoolbox","---","orange","https:\/\/developer.mozilla.org\/web","\/?WT.mc_id=","mdn38","https:\/\/developer.mozilla.org\/web\/?WT.mc_id=mdn38" ],
        [ "devtoolbox","---","red","https:\/\/developer.mozilla.org\/web","\/?WT.mc_id=","mdn39","https:\/\/developer.mozilla.org\/web\/?WT.mc_id=mdn39" ]
    ]
);

(function($) {

    function updateButtonCode (ev) {

        // Build a search spec from current selection state.
        var spec = {
            design: $('input:radio[name=button-design]:checked').val(),
            color:  $('input:radio[name=button-color]:checked').val(),
            topic:  $('input:radio[name=button-topic]:checked').val()
        };

        // Reveal / hide builder steps only if preceding conditions are met.
        $('#step-color')[ ( spec['design'] ) ? 'show':'hide' ]();
        $('#step-topic')[ ( spec['design'] && 'devtoolbox' != spec['design'] && spec['color'] ) ? 'show':'hide' ]();

        // Search through known combinations for a match
        var sel = null;
        for (var i=0,item; item=buttons[i]; i++) {
            // Be optimistic, assume a match until a column mismatch.
            var found = true;
            for (var k in spec) if (spec.hasOwnProperty(k)) {
                // Accept --- or selector value as column match.
                if ('---' != item[k] && spec[k] != item[k]) { 
                    found = false; break;
                }
            }
            // If nothing mismatched, then we have our item.
            if (found) { sel = item; break; }
        }

        // Reveal preview only if there's a valid selection.
        $('#button-preview')[ sel ? 'show':'hide' ]();

        // Do nothing if, somehow, a valid selection wasn't found.
        if (!sel) { return; }

        // Update the button preview image.
        $('#button-image').attr('src', '{{ MEDIA_URL }}img/promote/promobutton_'+sel.id+'.png');

        $('#button-url').text(sel.url).attr('href', sel.tracked_url);

        // var button_label = $('#button-design-'+sel.design+' + label').text();
        var button_label = $('#button-design-'+sel.design+' + label img').attr('alt');

        // Update the button code.
        $('#button-code').val([
            '<a href="', sel.tracked_url, '">',
            '<img src="{{ request.build_absolute_uri(MEDIA_URL) }}img/promote/promobutton_', sel.id, '.png" ', 
                'alt="', button_label, '">',
            '</a>'
        ].join(''));

    }

    // Update the button code on any change to selectors.
    $('#button-builder input:radio').click(updateButtonCode);
    $('#button-builder select').change(updateButtonCode);
    
    // Do an initial code update on page ready.
    $(document).ready(function () {
        updateButtonCode();
    });

    // Redirect clicks on topic links to radio selection.
    $('#step-topic a').click(function () { 
        $(this).parent().prev().click(); 
        updateButtonCode();
        return false; 
    });

    // Focusing on the code textarea selects all for copypasta
    $('#button-code').click(function (ev) { $(ev.target).select(); });

})(jQuery);

// ]]>
</script>
{% endblock %}
