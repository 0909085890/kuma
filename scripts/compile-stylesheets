#!/bin/bash

BASEDIR=$(dirname $0)
CSSDIR=$BASEDIR/../media/redesign/css
STYLUSDIR=$BASEDIR/../media/redesign/stylus

for opt in "$@"; do
  case $opt in
    --watch|-w) WATCH=true;;
  esac
done

if [ ! -d "$CSSDIR" ]; then
  mkdir $CSSDIR
fi

STYLESHEETS=(main wiki demo-studio profile search zones home wiki-syntax users)
if [ $WATCH ]; then
  for ss in ${STYLESHEETS[@]}; do
    (stylus $STYLUSDIR/$ss.styl --out $CSSDIR --compress --watch &) &> /dev/null
  done
  echo Watching and automatically compiling stylesheets
else
  for ss in ${STYLESHEETS[@]}; do
    stylus $STYLUSDIR/$ss.styl --out $CSSDIR --compress
  done
fi
